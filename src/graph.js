// import {store} from './store';
var data = {
   "id": "20020014",
   "a_nodes": {
         "3": {
            "label": "proper_q",
            "anchors": [
               4
            ],
            "incoming": [],
            "outgoing": [
               4
            ]
         },
         "4": {
            "label": "named",
            "anchors": [
               4
            ],
            "incoming": [
               3,
               19
            ],
            "outgoing": []
         },
         "5": {
            "label": "proper_q",
            "anchors": [
               5
            ],
            "incoming": [],
            "outgoing": [
               6
            ]
         },
         "6": {
            "label": "named",
            "anchors": [
               5
            ],
            "incoming": [
               5,
               17
            ],
            "outgoing": []
         },
         "7": {
            "label": "proper_q",
            "anchors": [
               6
            ],
            "incoming": [],
            "outgoing": [
               8
            ]
         },
         "8": {
            "label": "named",
            "anchors": [
               6
            ],
            "incoming": [
               7,
               15
            ],
            "outgoing": []
         },
         "9": {
            "label": "proper_q",
            "anchors": [
               7
            ],
            "incoming": [],
            "outgoing": [
               10
            ]
         },
         "10": {
            "label": "named",
            "anchors": [
               7
            ],
            "incoming": [
               9,
               11
            ],
            "outgoing": []
         },
         "12": {
            "label": "named",
            "anchors": [
               9
            ],
            "incoming": [
               11,
               13
            ],
            "outgoing": []
         },
         "13": {
            "label": "proper_q",
            "anchors": [
               9,
               10
            ],
            "incoming": [],
            "outgoing": [
               12
            ]
         },
         "14": {
            "label": "udef_q",
            "anchors": [
               7,
               8,
               9,
               10
            ],
            "incoming": [],
            "outgoing": [
               11
            ]
         },
         "15": {
            "label": "implicit_conj",
            "anchors": [
               7,
               8,
               9,
               10
            ],
            "incoming": [
               16,
               17
            ],
            "outgoing": [
               8,
               11
            ]
         },
         "16": {
            "label": "udef_q",
            "anchors": [
               6,
               7,
               8,
               9,
               10
            ],
            "incoming": [],
            "outgoing": [
               15
            ]
         },
         "17": {
            "label": "implicit_conj",
            "anchors": [
               6,
               7,
               8,
               9,
               10
            ],
            "incoming": [
               18,
               19
            ],
            "outgoing": [
               6,
               15
            ]
         },
         "18": {
            "label": "udef_q",
            "anchors": [
               5,
               6,
               7,
               8,
               9,
               10
            ],
            "incoming": [],
            "outgoing": [
               17
            ]
         },
         "19": {
            "label": "implicit_conj",
            "anchors": [
               5,
               6,
               7,
               8,
               9,
               10
            ],
            "incoming": [
               2,
               20
            ],
            "outgoing": [
               4,
               17
            ]
         },
         "20": {
            "label": "udef_q",
            "anchors": [
               4,
               5,
               6,
               7,
               8,
               9,
               10
            ],
            "incoming": [],
            "outgoing": [
               19
            ]
         },
         "27": {
            "label": "named_n",
            "anchors": [
               18
            ],
            "incoming": [
               25,
               26
            ],
            "outgoing": []
         },
         "30": {
            "label": "parg_d",
            "anchors": [
               21
            ],
            "incoming": [],
            "outgoing": [
               29,
               1
            ]
         },
         "33": {
            "label": "comp_less",
            "anchors": [
               25
            ],
            "incoming": [],
            "outgoing": [
               32,
               46
            ]
         },
         "37": {
            "label": "udef_q",
            "anchors": [
               29
            ],
            "incoming": [],
            "outgoing": [
               38
            ]
         },
         "41": {
            "label": "udef_q",
            "anchors": [
               30,
               31
            ],
            "incoming": [],
            "outgoing": [
               40
            ]
         },
         "42": {
            "label": "udef_q",
            "anchors": [
               29,
               30,
               31
            ],
            "incoming": [],
            "outgoing": [
               39
            ]
         },
         "44": {
            "label": "compound",
            "anchors": [
               29,
               30,
               31,
               32
            ],
            "incoming": [],
            "outgoing": [
               43,
               39
            ]
         },
         "45": {
            "label": "udef_q",
            "anchors": [
               28,
               29,
               30,
               31,
               32
            ],
            "incoming": [],
            "outgoing": [
               43
            ]
         },
         "46": {
            "label": "generic_entity",
            "anchors": [
               34
            ],
            "incoming": [
               33,
               47,
               48
            ],
            "outgoing": []
         },
         "50": {
            "label": "udef_q",
            "anchors": [
               37
            ],
            "incoming": [],
            "outgoing": [
               51
            ]
         },
         "53": {
            "label": "compound",
            "anchors": [
               37,
               38
            ],
            "incoming": [],
            "outgoing": [
               52,
               51
            ]
         },
         "54": {
            "label": "udef_q",
            "anchors": [
               24,
               25,
               26,
               27,
               28,
               29,
               30,
               31,
               32,
               33,
               34,
               35,
               36,
               37,
               38
            ],
            "incoming": [],
            "outgoing": [
               34
            ]
         }
   },
   "s_nodes": {
         "0": {
            "label": "_those_q_dem",
            "anchors": [
               0
            ],
            "incoming": [],
            "outgoing": [
               1
            ]
         },
         "1": {
            "label": "_country_n_of",
            "anchors": [
               1
            ],
            "incoming": [
               0,
               2,
               22,
               29,
               30,
               31
            ],
            "outgoing": []
         },
         "2": {
            "label": "_include_v_1",
            "anchors": [
               3
            ],
            "incoming": [],
            "outgoing": [
               1,
               19
            ]
         },
         "11": {
            "label": "_and_c",
            "anchors": [
               8
            ],
            "incoming": [
               14,
               15
            ],
            "outgoing": [
               10,
               12
            ]
         },
         "21": {
            "label": "_still_a_1",
            "anchors": [
               12
            ],
            "incoming": [],
            "outgoing": [
               22
            ]
         },
         "22": {
            "label": "_of_p",
            "anchors": [
               13
            ],
            "incoming": [
               21,
               28,
               28
            ],
            "outgoing": [
               1,
               24
            ]
         },
         "23": {
            "label": "_some_q",
            "anchors": [
               14
            ],
            "incoming": [],
            "outgoing": [
               24
            ]
         },
         "24": {
            "label": "_concern_n_1",
            "anchors": [
               15
            ],
            "incoming": [
               22,
               23,
               25
            ],
            "outgoing": []
         },
         "25": {
            "label": "_to_p",
            "anchors": [
               16
            ],
            "incoming": [],
            "outgoing": [
               24,
               27
            ]
         },
         "26": {
            "label": "_the_q",
            "anchors": [
               17
            ],
            "incoming": [],
            "outgoing": [
               27
            ]
         },
         "28": {
            "label": "_but_c",
            "anchors": [
               19
            ],
            "incoming": [],
            "outgoing": [
               22,
               22,
               29,
               29
            ]
         },
         "29": {
            "label": "_deem_v_1",
            "anchors": [
               21
            ],
            "incoming": [
               28,
               28,
               30
            ],
            "outgoing": [
               1,
               31
            ]
         },
         "31": {
            "label": "_pose_v_as",
            "anchors": [
               23
            ],
            "incoming": [
               29
            ],
            "outgoing": [
               1,
               34
            ]
         },
         "32": {
            "label": "_serious_a_1",
            "anchors": [
               25
            ],
            "incoming": [
               33
            ],
            "outgoing": [
               34
            ]
         },
         "34": {
            "label": "_problem_n_of",
            "anchors": [
               26
            ],
            "incoming": [
               31,
               54,
               32,
               35
            ],
            "outgoing": []
         },
         "35": {
            "label": "_for_p",
            "anchors": [
               27
            ],
            "incoming": [],
            "outgoing": [
               34,
               43
            ]
         },
         "36": {
            "label": "_american_a_1",
            "anchors": [
               28
            ],
            "incoming": [],
            "outgoing": [
               43
            ]
         },
         "38": {
            "label": "_patent_n_of",
            "anchors": [
               29
            ],
            "incoming": [
               37,
               39
            ],
            "outgoing": []
         },
         "39": {
            "label": "_and_c",
            "anchors": [
               30
            ],
            "incoming": [
               44,
               42
            ],
            "outgoing": [
               38,
               40
            ]
         },
         "40": {
            "label": "_copyright_n_1",
            "anchors": [
               31
            ],
            "incoming": [
               41,
               39
            ],
            "outgoing": []
         },
         "43": {
            "label": "_owner_n_of",
            "anchors": [
               32
            ],
            "incoming": [
               35,
               45,
               36,
               44
            ],
            "outgoing": []
         },
         "47": {
            "label": "_those_q_dem",
            "anchors": [
               34
            ],
            "incoming": [],
            "outgoing": [
               46
            ]
         },
         "48": {
            "label": "_on_p",
            "anchors": [
               35
            ],
            "incoming": [],
            "outgoing": [
               46,
               52
            ]
         },
         "49": {
            "label": "_the_q",
            "anchors": [
               36
            ],
            "incoming": [],
            "outgoing": [
               52
            ]
         },
         "51": {
            "label": "_priority_n_1",
            "anchors": [
               37
            ],
            "incoming": [
               53,
               50
            ],
            "outgoing": []
         },
         "52": {
            "label": "_list_n_of",
            "anchors": [
               38
            ],
            "incoming": [
               48,
               49,
               53
            ],
            "outgoing": []
         }
   },
   "edges": [
         {
            "src": 0,
            "trg": 1,
            "label": "RSTR/H"
         },
         {
            "src": 2,
            "trg": 1,
            "label": "ARG1/EQ"
         },
         {
            "src": 2,
            "trg": 19,
            "label": "ARG2/NEQ"
         },
         {
            "src": 20,
            "trg": 19,
            "label": "RSTR/H"
         },
         {
            "src": 18,
            "trg": 17,
            "label": "RSTR/H"
         },
         {
            "src": 16,
            "trg": 15,
            "label": "RSTR/H"
         },
         {
            "src": 3,
            "trg": 4,
            "label": "RSTR/H"
         },
         {
            "src": 5,
            "trg": 6,
            "label": "RSTR/H"
         },
         {
            "src": 7,
            "trg": 8,
            "label": "RSTR/H"
         },
         {
            "src": 9,
            "trg": 10,
            "label": "RSTR/H"
         },
         {
            "src": 13,
            "trg": 12,
            "label": "RSTR/H"
         },
         {
            "src": 19,
            "trg": 4,
            "label": "L-INDEX/NEQ"
         },
         {
            "src": 17,
            "trg": 6,
            "label": "L-INDEX/NEQ"
         },
         {
            "src": 15,
            "trg": 8,
            "label": "L-INDEX/NEQ"
         },
         {
            "src": 19,
            "trg": 17,
            "label": "R-INDEX/NEQ"
         },
         {
            "src": 17,
            "trg": 15,
            "label": "R-INDEX/NEQ"
         },
         {
            "src": 14,
            "trg": 11,
            "label": "RSTR/H"
         },
         {
            "src": 42,
            "trg": 39,
            "label": "RSTR/H"
         },
         {
            "src": 15,
            "trg": 11,
            "label": "R-INDEX/NEQ"
         },
         {
            "src": 11,
            "trg": 10,
            "label": "L-INDEX/NEQ"
         },
         {
            "src": 11,
            "trg": 12,
            "label": "R-INDEX/NEQ"
         },
         {
            "src": 21,
            "trg": 22,
            "label": "ARG1/EQ"
         },
         {
            "src": 22,
            "trg": 1,
            "label": "ARG1/NEQ"
         },
         {
            "src": 22,
            "trg": 24,
            "label": "ARG2/NEQ"
         },
         {
            "src": 23,
            "trg": 24,
            "label": "RSTR/H"
         },
         {
            "src": 25,
            "trg": 24,
            "label": "ARG1/EQ"
         },
         {
            "src": 25,
            "trg": 27,
            "label": "ARG2/NEQ"
         },
         {
            "src": 26,
            "trg": 27,
            "label": "RSTR/H"
         },
         {
            "src": 28,
            "trg": 22,
            "label": "L-HNDL/HEQ || L-INDEX/NEQ"
         },
         {
            "src": 28,
            "trg": 29,
            "label": "R-HNDL/HEQ || R-INDEX/NEQ"
         },
         {
            "src": 29,
            "trg": 1,
            "label": "ARG2/NEQ"
         },
         {
            "src": 29,
            "trg": 31,
            "label": "ARG3/H"
         },
         {
            "src": 30,
            "trg": 29,
            "label": "ARG1/EQ"
         },
         {
            "src": 30,
            "trg": 1,
            "label": "ARG2/NEQ"
         },
         {
            "src": 31,
            "trg": 1,
            "label": "ARG1/NEQ"
         },
         {
            "src": 31,
            "trg": 34,
            "label": "ARG2/NEQ"
         },
         {
            "src": 54,
            "trg": 34,
            "label": "RSTR/H"
         },
         {
            "src": 33,
            "trg": 32,
            "label": "ARG1/EQ"
         },
         {
            "src": 33,
            "trg": 46,
            "label": "ARG2/NEQ"
         },
         {
            "src": 32,
            "trg": 34,
            "label": "ARG1/EQ"
         },
         {
            "src": 35,
            "trg": 34,
            "label": "ARG1/EQ"
         },
         {
            "src": 35,
            "trg": 43,
            "label": "ARG2/NEQ"
         },
         {
            "src": 45,
            "trg": 43,
            "label": "RSTR/H"
         },
         {
            "src": 36,
            "trg": 43,
            "label": "ARG1/EQ"
         },
         {
            "src": 44,
            "trg": 43,
            "label": "ARG1/EQ"
         },
         {
            "src": 44,
            "trg": 39,
            "label": "ARG2/NEQ"
         },
         {
            "src": 37,
            "trg": 38,
            "label": "RSTR/H"
         },
         {
            "src": 41,
            "trg": 40,
            "label": "RSTR/H"
         },
         {
            "src": 39,
            "trg": 38,
            "label": "L-INDEX/NEQ"
         },
         {
            "src": 39,
            "trg": 40,
            "label": "R-INDEX/NEQ"
         },
         {
            "src": 47,
            "trg": 46,
            "label": "RSTR/H"
         },
         {
            "src": 48,
            "trg": 46,
            "label": "ARG1/EQ"
         },
         {
            "src": 48,
            "trg": 52,
            "label": "ARG2/NEQ"
         },
         {
            "src": 49,
            "trg": 52,
            "label": "RSTR/H"
         },
         {
            "src": 53,
            "trg": 52,
            "label": "ARG1/EQ"
         },
         {
            "src": 53,
            "trg": 51,
            "label": "ARG2/NEQ"
         },
         {
            "src": 50,
            "trg": 51,
            "label": "RSTR/H"
         }
   ],
   "tokens": {
         "0": {
            "form": "those",
            "lemma": "those"
         },
         "1": {
            "form": "countries",
            "lemma": "country"
         },
         "2": {
            "form": "\u2013",
            "lemma": "\u2013"
         },
         "3": {
            "form": "including",
            "lemma": "include"
         },
         "4": {
            "form": "japan,",
            "lemma": "Japan",
            "carg": "Japan"
         },
         "5": {
            "form": "italy,",
            "lemma": "Italy",
            "carg": "Italy"
         },
         "6": {
            "form": "canada,",
            "lemma": "Canada",
            "carg": "Canada"
         },
         "7": {
            "form": "greece",
            "lemma": "Greece",
            "carg": "Greece"
         },
         "8": {
            "form": "and",
            "lemma": "and"
         },
         "9": {
            "form": "spain",
            "lemma": "Spain",
            "carg": "Spain"
         },
         "10": {
            "form": "\u2013",
            "lemma": "\u2013"
         },
         "11": {
            "form": "are",
            "lemma": "are"
         },
         "12": {
            "form": "still",
            "lemma": "still"
         },
         "13": {
            "form": "of",
            "lemma": "of"
         },
         "14": {
            "form": "some",
            "lemma": "some"
         },
         "15": {
            "form": "concern",
            "lemma": "concern"
         },
         "16": {
            "form": "to",
            "lemma": "to"
         },
         "17": {
            "form": "the",
            "lemma": "the"
         },
         "18": {
            "form": "u.s.",
            "lemma": "US",
            "carg": "US"
         },
         "19": {
            "form": "but",
            "lemma": "but"
         },
         "20": {
            "form": "are",
            "lemma": "are"
         },
         "21": {
            "form": "deemed",
            "lemma": "deem"
         },
         "22": {
            "form": "to",
            "lemma": "to"
         },
         "23": {
            "form": "pose",
            "lemma": "pose"
         },
         "24": {
            "form": "less-",
            "lemma": "less-"
         },
         "25": {
            "form": "serious",
            "lemma": "serious"
         },
         "26": {
            "form": "problems",
            "lemma": "problem"
         },
         "27": {
            "form": "for",
            "lemma": "for"
         },
         "28": {
            "form": "american",
            "lemma": "american"
         },
         "29": {
            "form": "patent",
            "lemma": "patent"
         },
         "30": {
            "form": "and",
            "lemma": "and"
         },
         "31": {
            "form": "copyright",
            "lemma": "copyright"
         },
         "32": {
            "form": "owners",
            "lemma": "owner"
         },
         "33": {
            "form": "than",
            "lemma": "than"
         },
         "34": {
            "form": "those",
            "lemma": "those"
         },
         "35": {
            "form": "on",
            "lemma": "on"
         },
         "36": {
            "form": "the",
            "lemma": "the"
         },
         "37": {
            "form": "\u201cpriority\u201d",
            "lemma": "priority"
         },
         "38": {
            "form": "list.",
            "lemma": "list"
         }
   },
   "tops": {
         "28": {
            "label": "_but_c",
            "anchors": [
               19
            ],
            "incoming": [],
            "outgoing": [
               22,
               22,
               29,
               29
            ]
         }
   },
   "sentence": [
         "those",
         "countries",
         "\u2013",
         "including",
         "japan,",
         "italy,",
         "canada,",
         "greece",
         "and",
         "spain",
         "\u2013",
         "are",
         "still",
         "of",
         "some",
         "concern",
         "to",
         "the",
         "u.s.",
         "but",
         "are",
         "deemed",
         "to",
         "pose",
         "less-",
         "serious",
         "problems",
         "for",
         "american",
         "patent",
         "and",
         "copyright",
         "owners",
         "than",
         "those",
         "on",
         "the",
         "\u201cpriority\u201d",
         "list."
   ]
}
// },
// "20013017": {
//    "id": "20013017",
//    "a_nodes": {
//          "0": {
//             "label": "proper_q",
//             "anchors": [
//                0
//             ],
//             "incoming": [],
//             "outgoing": [
//                1
//             ]
//          },
//          "1": {
//             "label": "named",
//             "anchors": [
//                0
//             ],
//             "incoming": [
//                0,
//                2
//             ],
//             "outgoing": []
//          },
//          "3": {
//             "label": "pron",
//             "anchors": [
//                2
//             ],
//             "incoming": [
//                4,
//                6,
//                15
//             ],
//             "outgoing": []
//          },
//          "4": {
//             "label": "pronoun_q",
//             "anchors": [
//                2
//             ],
//             "incoming": [],
//             "outgoing": [
//                3
//             ]
//          },
//          "8": {
//             "label": "def_explicit_q",
//             "anchors": [
//                5
//             ],
//             "incoming": [],
//             "outgoing": [
//                12
//             ]
//          },
//          "9": {
//             "label": "poss",
//             "anchors": [
//                5
//             ],
//             "incoming": [],
//             "outgoing": [
//                12,
//                11
//             ]
//          },
//          "10": {
//             "label": "pronoun_q",
//             "anchors": [
//                5
//             ],
//             "incoming": [],
//             "outgoing": [
//                11
//             ]
//          },
//          "11": {
//             "label": "pron",
//             "anchors": [
//                5
//             ],
//             "incoming": [
//                9,
//                10
//             ],
//             "outgoing": []
//          },
//          "18": {
//             "label": "parg_d",
//             "anchors": [
//                12
//             ],
//             "incoming": [],
//             "outgoing": [
//                17,
//                19
//             ]
//          },
//          "22": {
//             "label": "named",
//             "anchors": [
//                16
//             ],
//             "incoming": [
//                20,
//                21
//             ],
//             "outgoing": []
//          },
//          "24": {
//             "label": "pron",
//             "anchors": [
//                19
//             ],
//             "incoming": [
//                25,
//                27
//             ],
//             "outgoing": []
//          },
//          "25": {
//             "label": "pronoun_q",
//             "anchors": [
//                19
//             ],
//             "incoming": [],
//             "outgoing": [
//                24
//             ]
//          },
//          "31": {
//             "label": "def_implicit_q",
//             "anchors": [
//                25
//             ],
//             "incoming": [],
//             "outgoing": [
//                33
//             ]
//          },
//          "33": {
//             "label": "season",
//             "anchors": [
//                26
//             ],
//             "incoming": [
//                30,
//                31,
//                32
//             ],
//             "outgoing": []
//          },
//          "35": {
//             "label": "def_explicit_q",
//             "anchors": [
//                28
//             ],
//             "incoming": [],
//             "outgoing": [
//                39
//             ]
//          },
//          "36": {
//             "label": "poss",
//             "anchors": [
//                28
//             ],
//             "incoming": [],
//             "outgoing": [
//                39,
//                38
//             ]
//          },
//          "37": {
//             "label": "pronoun_q",
//             "anchors": [
//                28
//             ],
//             "incoming": [],
//             "outgoing": [
//                38
//             ]
//          },
//          "38": {
//             "label": "pron",
//             "anchors": [
//                28
//             ],
//             "incoming": [
//                36,
//                37
//             ],
//             "outgoing": []
//          },
//          "42": {
//             "label": "generic_entity",
//             "anchors": [
//                32
//             ],
//             "incoming": [
//                40,
//                41,
//                43,
//                44,
//                45
//             ],
//             "outgoing": []
//          },
//          "43": {
//             "label": "card",
//             "anchors": [
//                32
//             ],
//             "incoming": [],
//             "outgoing": [
//                42
//             ]
//          },
//          "45": {
//             "label": "parg_d",
//             "anchors": [
//                33
//             ],
//             "incoming": [],
//             "outgoing": [
//                44,
//                42
//             ]
//          },
//          "47": {
//             "label": "udef_q",
//             "anchors": [
//                36
//             ],
//             "incoming": [],
//             "outgoing": [
//                48
//             ]
//          },
//          "50": {
//             "label": "compound",
//             "anchors": [
//                36,
//                37
//             ],
//             "incoming": [],
//             "outgoing": [
//                49,
//                48
//             ]
//          }
//    },
//    "s_nodes": {
//          "2": {
//             "label": "_say_v_to",
//             "anchors": [
//                1
//             ],
//             "incoming": [],
//             "outgoing": [
//                1,
//                13
//             ]
//          },
//          "5": {
//             "label": "_would_v_modal",
//             "anchors": [
//                3
//             ],
//             "incoming": [
//                13,
//                13
//             ],
//             "outgoing": [
//                6
//             ]
//          },
//          "6": {
//             "label": "_file_v_1",
//             "anchors": [
//                4
//             ],
//             "incoming": [
//                5,
//                7
//             ],
//             "outgoing": [
//                3,
//                12
//             ]
//          },
//          "7": {
//             "label": "_re-_a_again",
//             "anchors": [
//                4
//             ],
//             "incoming": [],
//             "outgoing": [
//                6
//             ]
//          },
//          "12": {
//             "label": "_request_n_for",
//             "anchors": [
//                6
//             ],
//             "incoming": [
//                6,
//                8,
//                9
//             ],
//             "outgoing": []
//          },
//          "13": {
//             "label": "_and_c",
//             "anchors": [
//                7
//             ],
//             "incoming": [
//                2
//             ],
//             "outgoing": [
//                5,
//                5,
//                23,
//                15
//             ]
//          },
//          "14": {
//             "label": "_still_a_1",
//             "anchors": [
//                8
//             ],
//             "incoming": [],
//             "outgoing": [
//                15
//             ]
//          },
//          "15": {
//             "label": "_hope_v_for",
//             "anchors": [
//                9
//             ],
//             "incoming": [
//                13,
//                14,
//                23
//             ],
//             "outgoing": [
//                3,
//                19
//             ]
//          },
//          "16": {
//             "label": "_a_q",
//             "anchors": [
//                11
//             ],
//             "incoming": [],
//             "outgoing": [
//                19
//             ]
//          },
//          "17": {
//             "label": "_expedite_v_1",
//             "anchors": [
//                12
//             ],
//             "incoming": [
//                18
//             ],
//             "outgoing": [
//                19
//             ]
//          },
//          "19": {
//             "label": "_review_n_of",
//             "anchors": [
//                13
//             ],
//             "incoming": [
//                15,
//                16,
//                17,
//                18,
//                20
//             ],
//             "outgoing": []
//          },
//          "20": {
//             "label": "_by_p",
//             "anchors": [
//                14
//             ],
//             "incoming": [],
//             "outgoing": [
//                19,
//                22
//             ]
//          },
//          "21": {
//             "label": "_the_q",
//             "anchors": [
//                15
//             ],
//             "incoming": [],
//             "outgoing": [
//                22
//             ]
//          },
//          "23": {
//             "label": "_so+that_x",
//             "anchors": [
//                17,
//                18
//             ],
//             "incoming": [
//                13
//             ],
//             "outgoing": [
//                15,
//                34
//             ]
//          },
//          "26": {
//             "label": "_could_v_modal",
//             "anchors": [
//                20
//             ],
//             "incoming": [
//                34
//             ],
//             "outgoing": [
//                27
//             ]
//          },
//          "27": {
//             "label": "_complete_v_2",
//             "anchors": [
//                21
//             ],
//             "incoming": [
//                26,
//                30
//             ],
//             "outgoing": [
//                24,
//                29
//             ]
//          },
//          "28": {
//             "label": "_the_q",
//             "anchors": [
//                22
//             ],
//             "incoming": [],
//             "outgoing": [
//                29
//             ]
//          },
//          "29": {
//             "label": "_purchase_n_of",
//             "anchors": [
//                23
//             ],
//             "incoming": [
//                27,
//                28
//             ],
//             "outgoing": []
//          },
//          "30": {
//             "label": "_by_p_temp",
//             "anchors": [
//                24
//             ],
//             "incoming": [],
//             "outgoing": [
//                27,
//                33
//             ]
//          },
//          "32": {
//             "label": "_next_a_1",
//             "anchors": [
//                25
//             ],
//             "incoming": [],
//             "outgoing": [
//                33
//             ]
//          },
//          "34": {
//             "label": "_if_x_then",
//             "anchors": [
//                27
//             ],
//             "incoming": [
//                23
//             ],
//             "outgoing": [
//                26,
//                40
//             ]
//          },
//          "39": {
//             "label": "_bid_n_1",
//             "anchors": [
//                29
//             ],
//             "incoming": [
//                35,
//                36,
//                40
//             ],
//             "outgoing": []
//          },
//          "40": {
//             "label": "_be_v_id",
//             "anchors": [
//                30
//             ],
//             "incoming": [
//                34
//             ],
//             "outgoing": [
//                39,
//                42
//             ]
//          },
//          "41": {
//             "label": "_the_q",
//             "anchors": [
//                31
//             ],
//             "incoming": [],
//             "outgoing": [
//                42
//             ]
//          },
//          "44": {
//             "label": "_approve_v_1",
//             "anchors": [
//                33
//             ],
//             "incoming": [
//                45
//             ],
//             "outgoing": [
//                49,
//                42
//             ]
//          },
//          "46": {
//             "label": "_the_q",
//             "anchors": [
//                35
//             ],
//             "incoming": [],
//             "outgoing": [
//                49
//             ]
//          },
//          "48": {
//             "label": "_bankruptcy_n_1",
//             "anchors": [
//                36
//             ],
//             "incoming": [
//                50,
//                47
//             ],
//             "outgoing": []
//          },
//          "49": {
//             "label": "_court_n_of",
//             "anchors": [
//                37
//             ],
//             "incoming": [
//                44,
//                46,
//                50
//             ],
//             "outgoing": []
//          }
//    },
//    "edges": [
//          {
//             "src": 0,
//             "trg": 1,
//             "label": "RSTR/H"
//          },
//          {
//             "src": 2,
//             "trg": 1,
//             "label": "ARG1/NEQ"
//          },
//          {
//             "src": 2,
//             "trg": 13,
//             "label": "ARG2/H"
//          },
//          {
//             "src": 4,
//             "trg": 3,
//             "label": "RSTR/H"
//          },
//          {
//             "src": 10,
//             "trg": 11,
//             "label": "RSTR/H"
//          },
//          {
//             "src": 25,
//             "trg": 24,
//             "label": "RSTR/H"
//          },
//          {
//             "src": 37,
//             "trg": 38,
//             "label": "RSTR/H"
//          },
//          {
//             "src": 5,
//             "trg": 6,
//             "label": "ARG1/H"
//          },
//          {
//             "src": 6,
//             "trg": 3,
//             "label": "ARG1/NEQ"
//          },
//          {
//             "src": 6,
//             "trg": 12,
//             "label": "ARG2/NEQ"
//          },
//          {
//             "src": 7,
//             "trg": 6,
//             "label": "ARG1/EQ"
//          },
//          {
//             "src": 8,
//             "trg": 12,
//             "label": "RSTR/H"
//          },
//          {
//             "src": 9,
//             "trg": 12,
//             "label": "ARG1/EQ"
//          },
//          {
//             "src": 9,
//             "trg": 11,
//             "label": "ARG2/NEQ"
//          },
//          {
//             "src": 36,
//             "trg": 38,
//             "label": "ARG2/NEQ"
//          },
//          {
//             "src": 13,
//             "trg": 5,
//             "label": "L-HNDL/HEQ || L-INDEX/NEQ"
//          },
//          {
//             "src": 13,
//             "trg": 23,
//             "label": "R-HNDL/HEQ"
//          },
//          {
//             "src": 13,
//             "trg": 15,
//             "label": "R-INDEX/NEQ"
//          },
//          {
//             "src": 14,
//             "trg": 15,
//             "label": "ARG1/NEQ"
//          },
//          {
//             "src": 15,
//             "trg": 3,
//             "label": "ARG1/NEQ"
//          },
//          {
//             "src": 15,
//             "trg": 19,
//             "label": "ARG2/NEQ"
//          },
//          {
//             "src": 16,
//             "trg": 19,
//             "label": "RSTR/H"
//          },
//          {
//             "src": 17,
//             "trg": 19,
//             "label": "ARG2/EQ"
//          },
//          {
//             "src": 18,
//             "trg": 17,
//             "label": "ARG1/EQ"
//          },
//          {
//             "src": 18,
//             "trg": 19,
//             "label": "ARG2/EQ"
//          },
//          {
//             "src": 20,
//             "trg": 19,
//             "label": "ARG1/EQ"
//          },
//          {
//             "src": 20,
//             "trg": 22,
//             "label": "ARG2/NEQ"
//          },
//          {
//             "src": 21,
//             "trg": 22,
//             "label": "RSTR/H"
//          },
//          {
//             "src": 23,
//             "trg": 15,
//             "label": "ARG1/H"
//          },
//          {
//             "src": 23,
//             "trg": 34,
//             "label": "ARG2/H"
//          },
//          {
//             "src": 26,
//             "trg": 27,
//             "label": "ARG1/H"
//          },
//          {
//             "src": 27,
//             "trg": 24,
//             "label": "ARG1/NEQ"
//          },
//          {
//             "src": 27,
//             "trg": 29,
//             "label": "ARG2/NEQ"
//          },
//          {
//             "src": 28,
//             "trg": 29,
//             "label": "RSTR/H"
//          },
//          {
//             "src": 30,
//             "trg": 27,
//             "label": "ARG1/EQ"
//          },
//          {
//             "src": 30,
//             "trg": 33,
//             "label": "ARG2/NEQ"
//          },
//          {
//             "src": 31,
//             "trg": 33,
//             "label": "RSTR/H"
//          },
//          {
//             "src": 32,
//             "trg": 33,
//             "label": "ARG1/EQ"
//          },
//          {
//             "src": 34,
//             "trg": 26,
//             "label": "ARG1/H"
//          },
//          {
//             "src": 34,
//             "trg": 40,
//             "label": "ARG2/H"
//          },
//          {
//             "src": 35,
//             "trg": 39,
//             "label": "RSTR/H"
//          },
//          {
//             "src": 36,
//             "trg": 39,
//             "label": "ARG1/EQ"
//          },
//          {
//             "src": 40,
//             "trg": 39,
//             "label": "ARG1/NEQ"
//          },
//          {
//             "src": 40,
//             "trg": 42,
//             "label": "ARG2/NEQ"
//          },
//          {
//             "src": 41,
//             "trg": 42,
//             "label": "RSTR/H"
//          },
//          {
//             "src": 43,
//             "trg": 42,
//             "label": "ARG1/EQ"
//          },
//          {
//             "src": 44,
//             "trg": 49,
//             "label": "ARG1/NEQ"
//          },
//          {
//             "src": 44,
//             "trg": 42,
//             "label": "ARG2/EQ"
//          },
//          {
//             "src": 45,
//             "trg": 44,
//             "label": "ARG1/EQ"
//          },
//          {
//             "src": 45,
//             "trg": 42,
//             "label": "ARG2/EQ"
//          },
//          {
//             "src": 46,
//             "trg": 49,
//             "label": "RSTR/H"
//          },
//          {
//             "src": 50,
//             "trg": 49,
//             "label": "ARG1/EQ"
//          },
//          {
//             "src": 50,
//             "trg": 48,
//             "label": "ARG2/NEQ"
//          },
//          {
//             "src": 47,
//             "trg": 48,
//             "label": "RSTR/H"
//          }
//    ],
//    "tokens": {
//          "0": {
//             "form": "Northeast",
//             "lemma": "Northeast",
//             "carg": "Northeast"
//          },
//          "1": {
//             "form": "said",
//             "lemma": "say"
//          },
//          "2": {
//             "form": "it",
//             "lemma": "it"
//          },
//          "3": {
//             "form": "would",
//             "lemma": "would"
//          },
//          "4": {
//             "form": "refile",
//             "lemma": "file"
//          },
//          "5": {
//             "form": "its",
//             "lemma": "its"
//          },
//          "6": {
//             "form": "request",
//             "lemma": "request"
//          },
//          "7": {
//             "form": "and",
//             "lemma": "and"
//          },
//          "8": {
//             "form": "still",
//             "lemma": "still"
//          },
//          "9": {
//             "form": "hopes",
//             "lemma": "hope"
//          },
//          "10": {
//             "form": "for",
//             "lemma": "for"
//          },
//          "11": {
//             "form": "an",
//             "lemma": "a"
//          },
//          "12": {
//             "form": "expedited",
//             "lemma": "expedite"
//          },
//          "13": {
//             "form": "review",
//             "lemma": "review"
//          },
//          "14": {
//             "form": "by",
//             "lemma": "by"
//          },
//          "15": {
//             "form": "the",
//             "lemma": "the"
//          },
//          "16": {
//             "form": "FERC",
//             "lemma": "FERC",
//             "carg": "FERC"
//          },
//          "17": {
//             "form": "so",
//             "lemma": "so"
//          },
//          "18": {
//             "form": "that",
//             "lemma": "that"
//          },
//          "19": {
//             "form": "it",
//             "lemma": "it"
//          },
//          "20": {
//             "form": "could",
//             "lemma": "could"
//          },
//          "21": {
//             "form": "complete",
//             "lemma": "complete"
//          },
//          "22": {
//             "form": "the",
//             "lemma": "the"
//          },
//          "23": {
//             "form": "purchase",
//             "lemma": "purchase"
//          },
//          "24": {
//             "form": "by",
//             "lemma": "by"
//          },
//          "25": {
//             "form": "next",
//             "lemma": "next"
//          },
//          "26": {
//             "form": "summer",
//             "lemma": "summer",
//             "carg": "summer"
//          },
//          "27": {
//             "form": "if",
//             "lemma": "if"
//          },
//          "28": {
//             "form": "its",
//             "lemma": "its"
//          },
//          "29": {
//             "form": "bid",
//             "lemma": "bid"
//          },
//          "30": {
//             "form": "is",
//             "lemma": "be"
//          },
//          "31": {
//             "form": "the",
//             "lemma": "the"
//          },
//          "32": {
//             "form": "one",
//             "lemma": "1",
//             "carg": "1"
//          },
//          "33": {
//             "form": "approved",
//             "lemma": "approve"
//          },
//          "34": {
//             "form": "by",
//             "lemma": "by"
//          },
//          "35": {
//             "form": "the",
//             "lemma": "the"
//          },
//          "36": {
//             "form": "bankruptcy",
//             "lemma": "bankruptcy"
//          },
//          "37": {
//             "form": "court.",
//             "lemma": "court"
//          }
//    },
//    "tops": {
//          "2": {
//             "label": "_say_v_to",
//             "anchors": [
//                1
//             ],
//             "incoming": [],
//             "outgoing": [
//                1,
//                13
//             ]
//          }
//    },
//    "sentence": [
//          "Northeast",
//          "said",
//          "it",
//          "would",
//          "refile",
//          "its",
//          "request",
//          "and",
//          "still",
//          "hopes",
//          "for",
//          "an",
//          "expedited",
//          "review",
//          "by",
//          "the",
//          "FERC",
//          "so",
//          "that",
//          "it",
//          "could",
//          "complete",
//          "the",
//          "purchase",
//          "by",
//          "next",
//          "summer",
//          "if",
//          "its",
//          "bid",
//          "is",
//          "the",
//          "one",
//          "approved",
//          "by",
//          "the",
//          "bankruptcy",
//          "court."
//    ]
// }

makeGraph(data, true,"body")
    function makeGraph(data,showTokens,elementId){
        
//  export const makeGraph = function (data, showTokens, elementId) {
var start = performance.now();
    var layers = {bottom:0,token:0,surface:0,top:10};
    var sNodes =[];
    var aNodes =[];
    var tokenList =[];
    var id = data.id;
    var a_nodes = Object.entries(data.a_nodes);
    var s_nodes = Object.entries(data.s_nodes);
    var dataEdges = Object.entries(data.edges);
    var dataTokens = Object.entries(data.sentence);
    var top = Object.entries(data.tops);
    
    //TOP IS A SPECIFIC THING TAHT NEEDS TO BE READ IN FROM THE DATA AND IS NOT NECESSARILY LABELLED.
    dataTokens.forEach(element => {
        tokenList.push(element);
    });
    a_nodes.forEach(element => {
        var dummyNodeA = {index:element[0],tokens:element[1].anchors,label:element[1].label,edges:element[1].outgoing,edgelabels:[],xPos:0,yPos:0,colour:"green"};
        //need to add edgelabel from edges
        aNodes.push(dummyNodeA);
    });
    s_nodes.forEach(element => {
        var dummyNodeS = {index:element[0],tokens:element[1].anchors,label:element[1].label,edges:element[1].outgoing,edgelabels:[],xPos:0,yPos:0,colour:"green"};
        sNodes.push(dummyNodeS);
    });
    
    var sNodeIndexes = sNodes.map(x => x.index);
    var aNodeIndexes = aNodes.map(x => x.index);
    var sNodeLabels = sNodes.map(x => x.label);
    var aNodeLabels = aNodes.map(x => x.label);
    var anchorArray =[{aLength:1, height:50}];
    
    var maxIndex = Math.max(Math.max(...aNodeIndexes),Math.max(...sNodeIndexes));
    
    top.forEach(element => {
        var i=1
        if(element[1].label[0] == "_"){
            var dummyNodeA = {index:maxIndex +i,tokens:sNodes[sNodeLabels.indexOf(element[1].label)].tokens,label:"TOP",edges:[],edgelabels:[],xPos:0,yPos:0, colour:"green",relation: element[1].label, abstract: false};
        }
        else{
            var dummyNodeA = {index:maxIndex +i,tokens:aNodes[aNodeLabels.indexOf(element[1].label)].tokens,label:"TOP",edges:[],edgelabels:[],xPos:0,yPos:0, colour:"green",relation: element[1].label, abstract: true};
        }
        i++;
        aNodes.push(dummyNodeA);
        aNodeLabels.push("TOP");
        aNodeIndexes.push(dummyNodeA.index);
    });
    dataEdges.forEach(element => {
        if(sNodeIndexes.includes(element[1].src.toString())){
            sNodes[sNodeIndexes.indexOf(element[1].src.toString())].edgelabels.push(element[1].label);
        }
        else{
            aNodes[aNodeIndexes.indexOf(element[1].src.toString())].edgelabels.push(element[1].label);
        }
    });

    // DEFINING A COLOUR SCALE TO THE NODES.
    var abstractColourScale = d3.scaleLinear().domain([0,aNodeIndexes.length]).range(["yellow", "red"]);
    var surfaceColourScale =  d3.scaleSequential().domain([0,sNodeIndexes.length]).interpolator(d3.interpolateCool);
    
    //DETERMINING THE COLOUR OF EACH NODE and determinging max anchor.
    for(var i=0; i<sNodes.length; i++){
        sNodes[i].colour = surfaceColourScale(i);
    }
    for(var i=0; i<aNodes.length; i++){
        if(!(anchorArray.map(x=>x.aLength).includes(aNodes[i].tokens.length))){
            anchorArray.push({aLength:aNodes[i].tokens.length, height:0});
        }
        aNodes[i].colour = abstractColourScale(i);
    }
    anchorArray = anchorArray.sort((a, b) => (a.aLength > b.aLength) ? 1 : -1)
    for(var i=0; i<anchorArray.length; i++){
        anchorArray[i].height = 85*(i+1);
    }
    let aMap = anchorArray.map(x=> x.aLength);
    console.log(aMap);

    // for a in anchorarry booga booga add 50
    
    // GRAPH SIZE DEFINITIONS.
    var width = tokenList.length*200;
    var offset = width/(tokenList.length*2);
    var maxSNodeHeight=0;
    var maxANodeHeight = 0;
    var minSNode = 0;
    var TopNodeHeight=0;
    var gapBetweenBottomNodeAndLayer = 100;
    var tokenGap = width/tokenList.length;
var layerText = ["Token layer", "Surface node layer", "Abstract node layer"];

// ARROW SIZE DEFINIITONS
const arrowPoints = [[0, 0], [0, 6], [6, 3]];

// GETTING POSITIONS OF NODE AND LAYER.
sNodes.forEach(element => {
    element.xPos = offset + (width/tokenList.length)*(element.tokens.reduce((a,b) => a+b,0)/element.tokens.length);
    element.yPos = 50*(element.tokens.length);
    maxSNodeHeight = Math.max(maxSNodeHeight,element.yPos);
});
aNodes.forEach(element => {
    element.xPos = offset + (width/tokenList.length)*(element.tokens.reduce((a,b) => a+b,0)/element.tokens.length);
    if(element.label == "TOP"){
        element.yPos = layers.top + 25; 
        TopNodeHeight = element.yPos;
    }
    else{
        element.yPos = anchorArray[aMap.indexOf(element.tokens.length)].height;
        maxANodeHeight = Math.max(maxANodeHeight,element.yPos);
    }
});

layers.surface = TopNodeHeight + gapBetweenBottomNodeAndLayer + maxANodeHeight +25; //height determined for surface layer marker.
aNodes.forEach(element =>{
    if(element.label != "TOP"){
        element.yPos = layers.surface - element.yPos -25;
    }
})
//RESOLVING CLASHES
for(var j=0;j<aNodes.length;j++){
    if(aNodes[j].label != "TOP"){
        for(var i =0; i< aNodes.length; i++) {
            if(aNodes[j].xPos == aNodes[i].xPos && aNodes[j].yPos == aNodes[i].yPos && aNodes[j].index != aNodes[i].index){
                aNodes[j].xPos = aNodes[j].xPos -tokenGap/4+17;
                aNodes[i].xPos = aNodes[i].xPos +tokenGap/4-17;
                j=0;
            }
        }
    }
}
sNodes.forEach(element => {
    element.yPos = layers.surface + 100 + maxSNodeHeight - element.yPos;
    minSNode = Math.max(minSNode,element.yPos);
});
layers.token = minSNode + 100;
layers.bottom = layers.token + 100;
if(showTokens){
    var height=layers.bottom +100;
}
else{
    var height = layers.bottom;
}

//  AT THIS POINT NODE HEIGHTS AND LAYER HEIGHTS HAVE BEEN DETERMINED.
var layerVals = Object.values(layers);

if ( elementId == "body" && document.getElementsByClassName("d3-graph").length === 5){
    d3.select("svg").remove();
} else if (elementId != "body") {
    elementId = `#${elementId}`
}
/// NEED TO CHECK IF elementId = displayModalOrWhatever, then remove element and reappend
var svg = d3.select(elementId).append("svg").attr("id", "viewSvg").attr("class", "d3-graph")
.attr("height", "400px").attr("width", 1000+"px")
.attr("viewBox","0,0,"+width +","+ height)

var group = svg.append("g").attr("id", "group");
var zoomGroup = group.append("g");
group.call(d3.zoom()
.scaleExtent([0.5, 6])
.translateExtent([[-width+500,-height-100],[width+100,height+100]])    
.on("zoom",function(){
    zoomGroup.attr("transform", d3.event.transform);
})); //allows for zooming

//ARROWHEAD DEFINITION
zoomGroup.append("defs").selectAll("marker.s").data(sNodes).enter().append("marker")
        .attr("class","s")
        .attr('id', function(d,i){return "arrow-"+id+d.index;})
        .attr('viewBox', [0, 0, 7, 7])
        .attr('refX', 3.5)
        .attr('refY', 3.5)
        .attr('markerWidth', 6)
        .attr('markerHeight', 6)
        .attr('orient', 'auto')
    .append('path')
        .attr('d', d3.line()(arrowPoints))
        .attr("fill", function(d,i){return d.colour;});
        
        zoomGroup.select("defs").selectAll("marker.a").data(aNodes).enter().append("marker")
        
        .attr("class","a")
        .attr('id', function(d,i){return "arrow-"+id+d.index;})
        .attr('viewBox', [0, 0, 7, 7])
        .attr('refX', 3.5)
        .attr('refY', 3.5)
        .attr('markerWidth', 6)
        .attr('markerHeight', 6)
        .attr('orient', 'auto')
        .append('path')
        .attr('d', d3.line()(arrowPoints))
        .attr("fill", function(d,i){return d.colour;});
        
        function drawLine(colour, data, index){
            var line = d3.line()
    .x(function(d){return d.x;})
    .y(function(d){return d.y;})
    .curve(d3.curveBundle);
    zoomGroup.append("path")
    .attr("d",line(data))
    .attr("stroke", colour)
    .attr("stroke-width","2")
    .attr("marker-end", "url(#arrow-"+id+index+")")
    .attr("fill", "none");
};

//BACKGROUND RECTANGLE
zoomGroup.append("rect")
.attr("class","back")
.attr("height","100%")
    .attr("width","100%")
    .attr("x","0")
    .attr("y","0")
    .attr("fill","#f2f0f0")
    .lower();
    
    // DRAWING LAYER LINES
    if(!(showTokens)){
    layerVals[0] = layerVals[1];
    layerText.splice(0,1);
}
zoomGroup.selectAll("line.layers").data(layerVals).enter().append("line")
    .attr("class","layers")
    .attr("x1","0")
    .attr("y1",function(d,i){return d;})
    .attr("x2",width.toString())
    .attr("y2",function(d,i){return d;})
    .attr("stroke","gray")
    .attr("stroke-width","2");
    
// DRAWING TOKENS
if(showTokens){
    zoomGroup.append("text").selectAll("text.tokens").data(tokenList).enter().append("tspan").text(d => d)
    .attr("class","tokens")
    .attr("x",function(d,i){return offset + i*tokenGap;})
    .attr("y",function(){return layers.bottom - 50;}) //change with depth of token layer.
    .attr("font-size","30")
    .attr("text-anchor","middle")
    .attr("dominant-baseline","middle")
    .attr("fill","black")
        .attr("font-family","Arial");
        
        // DRAWING TOKEN->NODE DASHES.
    zoomGroup.selectAll("line.relations").data(sNodes).enter().append("line")
    .attr("class","relations")
    .attr("x1",function(d,i){return d.xPos;})
    .attr("y1",function(d,i){return d.yPos + 23;})
    .attr("x2",function(d,i){return d.xPos;})
        .attr("y2",function(d,i){return layers.bottom - 70;})
        .attr("stroke-dasharray","3,3")
        .attr("stroke","gray")
        .attr("stroke-width","2");
    }
//labelling layers
zoomGroup.append("text").selectAll("text.layerText").data(layerText).enter().append("tspan").text(d => d)
.attr("class","layerText")
    .attr("x",function(d,i){return 10;})
    .attr("y",function(d,i){if(showTokens){
        return layerVals[i]-5;
    }return layerVals[i+1]-5;})
    .attr("font-size","16")
    .attr("fill","gray")
    .attr("font-family","Arial");

//displaying graph label
zoomGroup.append("text").selectAll("text.graphlabel").data(["Graph number: " + id]).enter().append("tspan").text(d => d)
.attr("class","graphlabel")
    .attr("x",width/2)
    .attr("y",height-40)
    .attr("font-size","32")
    .attr("stroke-width", "1400")
    .attr("fill","black")
    .attr("font-family","Arial");
    
    
    // DRAWING SURFACE NODES
    zoomGroup.selectAll("circle.nodes").data(sNodes).enter().append("circle")
    .attr("class","nodes")
    .attr("cx",function(d,i){return d.xPos})
    .attr("cy",function(d,i){return d.yPos;})
    .attr("r","12")
    .attr("fill", function(d,i){return d.colour;})
    .on("click", function(d,i){store.dispatch("setNewSubsetToDisplay", {graphId: id, nodeId: d.index});})
    .on("mouseover", function(d,i){mouseHover(d.colour,d.tokens,id,"s",d.index)})
    .on("mouseout", function(d,i){return mouseOut("s",d.index,id);});

// HIGHLIGHTING ANCHORS
if(showTokens){
    zoomGroup.selectAll("rect.highlights")
    .data(tokenList)
    .enter().append("rect")
    .attr("class",function(d,i){return "highlights rectangle"+id+i;}) //index of the token
    .attr("height","35")
    .attr("width",function(d,i){return 200;})
    .attr("x",function(d,i){return offset + i*tokenGap -100;})
    .attr("y",function(d,i){return layers.bottom - 67;})
    .attr("fill", "none")
    .style("opacity","0.4");
}

//LABELLING NODES.
zoomGroup.selectAll("rect.slabels")
    .data(sNodes)
    .enter().append("rect")
    .attr("class", function(d,i){return "slabels"+id+d.index ;})
    .attr("height","20")
    .attr("width",function(d,i){return d.label.length*8 + "";}) //changes with length of the label.
    .attr("x",function(d,i){return d.xPos- d.label.length*4;})
    .attr("y",function(d,i){return d.yPos + 33;})
    .attr("stroke", function(d,i){return d.colour;})
    .attr("stroke-width", "2")
    .attr("fill", "#f2f0f0");
zoomGroup.append("text").selectAll("text.nodeLabels").data(sNodeLabels).enter().append("tspan").text(d => d)
    .attr("class","nodeLabels")
    .attr("x",function(d,i){return sNodes[i].xPos;})
    .attr("y",function(d,i){return sNodes[i].yPos + 43;})
    .attr("font-size","12px")
    .attr("text-anchor","middle")
    .attr("font-weight", "900")
    .attr("dominant-baseline","middle")
    .attr("fill","black")
    .attr("font-family","Arial");

//  SURFACE EDGES
sNodes.forEach(element => {
    if(element.edges[0] != -1){
        for(var i=0; i<element.edges.length ;i++){
            var otherSNode = sNodes[sNodeIndexes.indexOf(element.edges[i].toString())];
            var otherANode = aNodes[aNodeIndexes.indexOf(element.edges[i].toString())];
            if(sNodeIndexes.includes(element.edges[i].toString())){
                var abDiffX = Math.abs(element.xPos - otherSNode.xPos);
                if(element.xPos >= otherSNode.xPos ){
                    if(abDiffX < 240){
                        var fromToS = [{x:element.xPos -14,y:element.yPos},{x:otherSNode.xPos +17,y:otherSNode.yPos}];
                    }
                    else{
                        var fromToS = [{x:element.xPos -14,y:element.yPos -14},
                            {x:element.xPos -abDiffX/11 ,y:element.yPos - abDiffX/11 },
                            {x:otherSNode.xPos +abDiffX/11,y:otherSNode.yPos -abDiffX/11},
                            {x:otherSNode.xPos +14,y:otherSNode.yPos -14}]; //needs worku
                    }
                }
                else{
                    if(abDiffX < 240){
                        var fromToS = [{x:element.xPos +14,y:element.yPos},{x:otherSNode.xPos -17,y:otherSNode.yPos}];
                    }
                    else{
                        var limitLine = 130;
                        var edgeLineYAxis = Math.min(limitLine, abDiffX/12);
                        var fromToS = [{x:element.xPos +14,y:element.yPos},
                            {x:element.xPos +edgeLineYAxis,y:element.yPos +edgeLineYAxis},
                            {x:otherSNode.xPos -edgeLineYAxis,y:otherSNode.yPos +edgeLineYAxis},
                            {x:otherSNode.xPos -17,y:otherSNode.yPos + 8}]; //needs worku
                    }
                }
            }
            else{
                if(element.xPos > otherANode.xPos){
                    var fromToS = [{x:element.xPos-10.5,y:element.yPos -10.5},
                        {x:element.xPos -83 ,y:element.yPos -80 },
                        {x:otherANode.xPos +89,y:otherANode.yPos -80},
                        {x:otherANode.xPos +12.5,y:otherANode.yPos -12.5}]; //needs worku
                }
                else if (element.xPos == otherANode.xPos){
                    var fromToS = [{x:element.xPos,y:element.yPos -14},
                        {x:element.xPos -83 ,y:element.yPos -80 },
                        {x:otherANode.xPos +89,y:otherANode.yPos -80},
                        {x:otherANode.xPos ,y:otherANode.yPos -16}]; //needs worku
                }
                else{
                    var fromToS = [{x:element.xPos + 10.4,y:element.yPos -10.5},
                        {x:element.xPos +87,y:element.yPos -60},
                        {x:otherANode.xPos -83,y:otherANode.yPos -17+80},
                        {x:otherANode.xPos -12.5,y:otherANode.yPos +12.5}]; //needs worku
                }
            }
            drawLine(element.colour,fromToS, element.index);
 // LABEL
    var labelX = (fromToS[0].x+fromToS[1].x)/2 + 10;
    var labelY = (fromToS[0].y+fromToS[1].y)/2 + 10;
    zoomGroup.selectAll("text.aLabels").data([element]).enter().append("text")
        .text(d=> d.edgelabels[i])
        .attr("x",labelX.toString())
        .attr("y",labelY.toString())
        .attr("font-family","Arial")
        .attr("font-size","14px")
        .attr("dominant-baseline", "middle")
        .attr("text-anchor","middle")
        .attr("fill", "black");
        }
    }
});

//  EDGES OF ABSTRACT NODES
aNodes.forEach(element => {
    if(element.label == "TOP"){
    zoomGroup.selectAll("line.top").data([element]).enter().append("line")
        .attr("class","top")
        .attr("x1",function(d,i){return d.xPos;})
        .attr("y1",function(d,i){return d.yPos + 23;})
        .attr("x2",function(d,i){return d.xPos;})
        .attr("y2",function(d,i){if(!(element.abstract)){
            return sNodes[sNodeLabels.indexOf(d.relation.toString())].yPos -14;
        }
        else{
            return aNodes[aNodeLabels.indexOf(d.relation.toString())].yPos -14;
        }})
        .attr("stroke-dasharray","3,3")
        .attr("stroke",function(d,i){return d.colour;})
        .attr("stroke-width","2");
    };
    //EDGE
    for(var i =0; i< element.edges.length; i++){
        var otherSNode = sNodes[sNodeIndexes.indexOf(element.edges[i].toString())] ;
        var otherANode = aNodes[aNodeIndexes.indexOf(element.edges[i].toString())];
        if(sNodeIndexes.includes(element.edges[i].toString())){
            if(element.xPos > otherSNode.xPos){
                var fromTo = [{x:element.xPos -10.5 ,y:element.yPos +10.5},{x:otherSNode.xPos +10.5,y:otherSNode.yPos-14.5}];
            }
            else if(element.xPos == otherSNode.xPos){
                var fromTo = [{x:element.xPos ,y:element.yPos +14},{x:otherSNode.xPos,y:otherSNode.yPos-17}];
            }
            else{
                var fromTo = [{x:element.xPos +10.5 ,y:element.yPos +10.5},{x:otherSNode.xPos -10.5,y:otherSNode.yPos-14.5}];
            }
        }
        else{
            if(element.xPos >= otherANode.xPos){
                if(element.yPos >= otherANode.yPos){
                    var fromTo = [{x:element.xPos -10.5,y:element.yPos +10.5},{x:otherANode.xPos+12.5,y:otherANode.yPos+12.5}];   
                }
                else if(element.yPos == otherANode.yPos){

                }
                else{
                    var fromTo = [{x:element.xPos -17,y:element.yPos},{x:otherANode.xPos+20,y:otherANode.yPos}];   
                }
            }else{
                if(element.yPos > otherANode.yPos){ //when Y is LOWER than other.y
                    var fromTo = [{x:element.xPos +10.5,y:element.yPos -10.5},{x:otherANode.xPos-12.5,y:otherANode.yPos+12.5}];   
                }
                else if(element.yPos == otherANode.yPos){
                    var fromTo = [{x:element.xPos +14,y:element.yPos},{x:otherANode.xPos-16.5,y:otherANode.yPos}];
                }
                else{
                    var fromTo = [{x:element.xPos +10.5,y:element.yPos +10.5},{x:otherANode.xPos-12.5,y:otherANode.yPos-12.5}];
                }
            }
        }
        var line = d3.line()
                        .x(function(d){return d.x;})
                        .y(function(d){return d.y;});
        drawLine(element.colour,fromTo, element.index);

        //LABEL
        var labelX = (fromTo[0].x + fromTo[1].x)/2;
        var labelY = (fromTo[0].y + fromTo[1].y)/2 -8; //THIS WILL HAVE TO BE CHANGED IF PATHS BECOME CURVED.
        zoomGroup.selectAll("text.aLabels").data([element]).enter().append("text")
            .text(d=> d.edgelabels[i])
            .attr("x",labelX.toString())
            .attr("y",labelY.toString())
            .attr("font-family","Arial")
            .attr("font-size","14px")
            .attr("fill","#242424")
            .attr("text-anchor","middle");
    }

});
// ABSTRACT NODES
zoomGroup.selectAll("circle.aNodes").data(aNodes).enter().append("circle")
    .attr("class","aNodes")
    .attr("cx",function(d,i){return d.xPos;})
    .attr("cy",function(d,i){return d.yPos;})
    .attr("r",function(d,i){
        if(d.label=="TOP"){
            return "18";
        }
        return "12";})
    .attr("fill", function(d,i){return d.colour;})
    .on("click", function(d,i){ store.dispatch("setNewSubsetToDisplay", {graphId: id, nodeId: d.index});})
    .on("mouseover", function(d,i){mouseHover(d.colour,d.tokens,id,"a",d.index)})
    .on("mouseout", function(d,i){return mouseOut("a",d.index,id);}); 
//ABSTRACT NODE LABELS - redo this so edges dont overwrite?
zoomGroup.selectAll("rect.alabels")
    .data(aNodes)
    .enter().append("rect")
    .attr("class",function(d,i){return "alabels"+id+d.index;})
    .attr("height","20")
    .attr("width",function(d,i){return d.label.length*8 + 4 + "" ;})
    .attr("x",function(d,i){return d.xPos - d.label.length*4 -2 + "";})
    .attr("y",function(d,i){return d.yPos + 20;})
    .attr("stroke", function(d,i){return d.colour;})
    .attr("stroke-width", "2")
    .attr("fill", "#f2f0f0");
zoomGroup.append("text").selectAll("text.anodeLabels").data(aNodeLabels).enter().append("tspan").text(d => d)
    .attr("class","anodeLabels")
    .attr("x",function(d,i){return aNodes[i].xPos;})
    .attr("y",function(d,i){return aNodes[i].yPos + 33;})
    .attr("font-size","12px")
    .attr("text-anchor","middle")
    .attr("font-weight", "900")
    .attr("dominant-baseline","middle")
    .attr("fill","black")
    .attr("font-family","Arial");

var end = performance.now();
console.log("Making the graph took " + (end - start) + " milliseconds.") 
}

function mouseHover(colour, anchors, id,type,index){
    // console.log(colour);
    for(var i=0; i<anchors.length; i++){
        d3.selectAll("rect.rectangle"+id+anchors[i])
        .attr("fill", colour);
    }
    d3.select("rect."+type+"labels"+id+index)
    // .raise()
    .attr("fill", colour)
    .style("opacity","0.7");
};
function mouseOut(type,index,id){
    d3.selectAll("rect.highlights")
    .attr("fill", "none");
    d3.select("rect."+type+"labels"+id+index)
    // .lower()
    .attr("fill", "#f2f0f0")
    .style("opacity","1");

};
